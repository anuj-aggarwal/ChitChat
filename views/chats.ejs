<!doctype html>
<html lang="en">
<head>

    <% include partials/header %>

    <title><%= user.name %></title>

    <!-- Custom CSS: common.css -->
    <link rel="stylesheet" href="/css/common.css">
    <!-- Custom CSS: chats.css -->
    <link rel="stylesheet" href="/css/chats.css">

    <!-- Custom JS: common.js -->
    <script src="/js/common.js"></script>


</head>

<body>

<% include partials/sidebar %>

<!-- MAIN CHATS PAGE HERE -->
<div id="main">
    <!-- Chats Heading -->
    <div class="container green lighten-3" id="chats-heading">
        <h2 class="center">
            <!-- HAMBURGER FOR SLIDE-OUT PROFILE SIDENAV -->
            <a href="#" id="profile-collapse" data-activates="profile-sidebar"
               class="button-collapse hide-on-large-only left">
                <i class="fa fa-bars"></i>
            </a>
            Chats
        </h2>
    </div>
    <div class="container">
        <!-- Success Alerts -->
        <% if(success && success.length > 0) { %>
        <div id="alert-message" class="ui positive message">
            <p><%= success %></p>
        </div>
        <% } %>
        <!-- Error Alerts -->
        <% if(error && error.length > 0) { %>
        <div id="alert-message" class="ui error message">
            <p><%= error %></p>
        </div>
        <% } %>

        <!-- FOR EACH CHAT, ADD A ROW FOR THE CHAT -->
        <% chats.forEach(function(chat){ %>
        <a href="<%= chat.link %>">
            <!-- Background Green if unreadMessages present, else Grey -->
            <div class="row chat-row <% if(chat.unreadMessages == 0) { %>grey<% } else { %> green<% } %> lighten-4">
                <!-- Image of Other Chatter/Group Image -->
                <div class="col s2">
                    <img src="https://via.placeholder.com/60x60" class="circle responsive-img inline"
                         alt="Chat Receiver Image">
                </div>
                <!-- Name of Chat(Other User name/Group Name) -->
                <div class="col s10">
                    <h4 class="inline chat-name">
                        <%= chat.to %>
                        <% if(chat.unreadMessages !== 0) { %>
                        <span class="new badge green"><%= chat.unreadMessages %></span>
                        <% } %>
                    </h4>
                </div>
            </div>
        </a>
        <% }) %>
        <!-- END OF FOR LOOP -->
    </div>  <!-- END OF CHATS CONTAINER -->
</div>  <!-- END OF MAIN PAGE -->

</body>
</html>